<!-- <!DOCTYPE html>
<html>
  <head>
    <title>График температуры</title>
    <script src="https://cdn.jsdelivr.net/npm/chart.js"></script>
  </head>
  <body>
    <canvas id="tempChart" width="400" height="200"></canvas>

    <script>
      // Пример данных
      const timeArray = [1672531200, 1672534800, 1672538400]; // Unix Epoch
      const temperatureArray = [20, 22, 19]; // °C
      setInterval(() => {
        timeArray.push(Date.now());
        temperatureArray.push(Math.random() * 50);
        console.log(timeArray, temperatureArray);
      }, 1000);
      // Преобразование времени в читаемый формат
      const formattedTime = timeArray.map((timestamp) => {
        const date = new Date(timestamp * 1000); // Преобразуем в миллисекунды
        return date.toLocaleTimeString(); // Форматируем в HH:MM:SS
      });

      // Создаем график
      const ctx = document.getElementById('tempChart').getContext('2d');
      const tempChart = new Chart(ctx, {
        type: 'line',
        data: {
          labels: formattedTime, // Подписи по оси X (время)
          datasets: [
            {
              label: 'Температура (°C)',
              data: temperatureArray,
              borderColor: 'rgb(75, 192, 192)',
              tension: 0.1,
            },
          ],
        },
        options: {
          scales: {
            x: {
              title: {
                display: true,
                text: 'Время',
              },
            },
            y: {
              title: {
                display: true,
                text: 'Температура (°C)',
              },
            },
          },
        },
      });
    </script>
  </body>
</html> -->

<!DOCTYPE html>
<html>
  <head>
    <title>График температуры</title>
    <script src="https://cdn.jsdelivr.net/npm/chart.js"></script>
  </head>
  <body>
    <canvas id="tempChart" width="800" height="400"></canvas>

    <!-- <script>
      // Пример данных
      const timeData = [1672531200, 1672617600, 1672704000, 1672790400]; // Unix Epoch
      const tempData = [22.5, 20.3, 18.7, 21.4]; // °C

      // Конвертация времени в читаемый формат
      const formatDate = (timestamp) => {
        const date = new Date(timestamp * 1000);
        return date.toLocaleDateString('ru-RU', {
          day: 'numeric',
          month: 'short',
          hour: '2-digit',
          minute: '2-digit',
        });
      };

      // Создание графика
      const ctx = document.getElementById('tempChart').getContext('2d');
      const chart = new Chart(ctx, {
        type: 'line',
        data: {
          labels: timeData.map(formatDate),
          datasets: [
            {
              label: 'Температура (°C)',
              data: tempData,
              borderColor: 'rgb(255, 99, 132)',
              backgroundColor: 'rgba(255, 99, 132, 0.1)',
              borderWidth: 2,
              pointRadius: 4,
              fill: true,
              tension: 0.3,
            },
          ],
        },
        options: {
          responsive: true,
          scales: {
            x: {
              title: {
                display: true,
                text: 'Время',
                font: {
                  size: 14,
                  weight: 'bold',
                },
              },
              grid: {
                display: false,
              },
            },
            y: {
              title: {
                display: true,
                text: 'Температура (°C)',
                font: {
                  size: 14,
                  weight: 'bold',
                },
              },
              suggestedMin: Math.min(...tempData) - 2,
              suggestedMax: Math.max(...tempData) + 2,
            },
          },
          plugins: {
            tooltip: {
              callbacks: {
                title: (items) => formatDate(timeData[items[0].dataIndex]),
                label: (context) => `Температура: ${context.parsed.y}°C`,
              },
            },
            legend: {
              position: 'top',
              labels: {
                font: {
                  size: 14,
                },
              },
            },
          },
        },
      });

      function addDataPoint(timestamp, temperature) {
        // Добавляем новую точку в конец набора данных
        chart.data.datasets[0].data.push({
          x: timestamp,
          y: temperature,
        });

        // Обновляем график с анимацией
        chart.update();
      }

      setInterval(() => {
        // timeData.push(Date.now());
        // tempData.push(Math.random() * 50);
        // console.log(timeData, tempData);
        // chart.update();
        addDataPoint(Date.now(), Math.random() * 50);
      }, 1000);
    </script> -->
    <script src="index.js"></script>
  </body>
</html>
